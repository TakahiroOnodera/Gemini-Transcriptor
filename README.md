# Transcriptor
GeminiとVibe Codingして作っためちゃニッチな業務ツール（非汎用）

## 1. このツールについて

このツールは、複数のExcelファイルから指定した範囲のデータを抽出し、特定のレイアウトを持つ「ひな形ファイル」に転記後、個別のファイルとして自動で保存するためのVBAマクロです。

**目的:** 手作業で行っていた定型的なコピー＆ペースト作業を自動化し、作業時間の大幅な短縮と、転記ミスなどのヒューマンエラーを削減します。

---

## 2. 主な機能

* **一括処理:** フォルダ内にある複数のExcelファイルを自動で順番に処理します。
* **ひな形利用:** あらかじめレイアウトが定義されたひな形ファイルを使用するため、出力ファイルのフォーマットが統一されます。
* **柔軟な転記範囲:** 処理の実行時に「Up (`u`)」か「Down (`d`)」を選択することで、転記するデータの列範囲を動的に変更できます。
* **シート構成の再現:** 転記元ファイルに含まれる全てのシートを、新しいファイルに1対1で再現します。
* **自動リネーム:** 生成されたファイルは「（元のファイル名）\_転記済み」という名前で自動保存されるため、元のファイルと混同することがありません。

---

## 3. 準備するもの

### 3.1. ツール本体

* このVBAマクロが保存されているExcelファイル（`.xlsm`形式）。
* （GitHubから利用する場合）`Transcriptor.bas`などのVBAコードファイル。

### 3.2. 転記元データ

* 処理したいExcelファイル（`.xlsx`, `.xls`など）を、一つのフォルダにまとめてください。
* **フォルダの場所はどこでも構いません。**

### 3.3. ひな形ファイル

* 転記先のレイアウトとなるExcelファイルを1つ用意してください。
* このファイルには、必ず`JZXXXXXX　電文定義書`という名前のシートを含めてください。マクロはこのシートをコピーして新しいシートを作成します。
* **ファイルの場所はどこでも構いません。**

---

## 4. 使い方

1.  マクロが保存されているExcelファイルを開き、**「マクロの有効化」**を許可してください。
2.  開発タブからマクロを実行するか、シートに配置されたボタンをクリックしてマクロを起動します。
3.  **3つのポップアップが順番に表示されます。** 画面の指示に従って、以下のものを選択してください。
    1.  **転記元フォルダ:** 準備した、処理対象のファイルが入っているフォルダを選択します。
    2.  **ひな形ファイル:** 準備した、レイアウトの元となるExcelファイルを選択します。
    3.  **保存先フォルダ:** 処理後のファイルを保存したいフォルダを選択します。
4.  **方向選択のポップアップが表示されます。**
    * `u` を入力 → `A列`から`T列`までのデータを転記します。
    * `d` を入力 → `A列`から`M列`までのデータを転記します。
5.  入力後、自動処理が開始されます。処理が完了するとメッセージが表示されます。
6.  指定した**保存先フォルダ**に、「（元のファイル名）\_転記済み」という名前のファイルが作成されていることを確認してください。

---

## 5. GitHubからのコード利用方法 (インポート手順)

GitHubから`Transcriptor.bas`のようなVBAコードファイルのみをダウンロードした場合、以下の手順でご自身のExcelファイルにマクロを組み込むことができます。

1.  **Excelファイルの準備:**
    * 新しいExcelファイルを開き、「名前を付けて保存」でファイルの種類を**「Excel マクロ有効ブック (*.xlsm)」**として保存します。
2.  **VBE（Visual Basic Editor）を開く:**
    * Excelで `Alt` + `F11` キーを同時に押して、VBEエディタを開きます。
3.  **モジュールのインポート:**
    * VBEのメニューから `ファイル` > `ファイルのインポート` を選択します。
    * ダウンロードした`Transcriptor.bas`ファイルを選択し、「開く」をクリックします。
    * 左側の「プロジェクト」ウィンドウに「標準モジュール」フォルダと、その中に`Module1`（またはダウンロードしたファイル名）が追加されたことを確認します。
4.  **保存と実行:**
    * `Ctrl` + `S` キーで上書き保存し、VBEを閉じます。
    * これで、上記「4. 使い方」の手順でマクロを実行できるようになります。

---

## 6. 注意事項

* 処理中はExcelの画面が固まったように見えることがありますが、バックグラウンドで処理が進行しています。完了メッセージが表示されるまでお待ちください。
* 転記元フォルダにExcel以外のファイルが含まれていても問題ありません。マクロはExcelファイル（`.xls*`）のみを対象とします。
* ひな形ファイルに`JZXXXXXX　電文定義書`という名前のシートが存在しない場合、そのファイルの処理はスキップされます。
* 転記元のシート名にExcelで使えない禁則文字（例: `?`, `*`, `/`など）が含まれている場合、その文字は自動的にアンダースコア `_` に置き換えられます。
